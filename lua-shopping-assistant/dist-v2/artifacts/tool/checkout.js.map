{
  "version": 3,
  "sources": ["tool-checkout.ts", "../../src/tools/EcommerceTool.ts"],
  "sourcesContent": ["\n// =============================================================================\n// AUTO-GENERATED ENTRY POINT (Class-based)\n// Tool: checkout\n// Source: /Users/raresastilean/Documents/Lua/Repos/lua-dev-examples/lua-shopping-assistant/src/tools/EcommerceTool.ts\n// =============================================================================\n\nimport { CheckoutTool } from '/Users/raresastilean/Documents/Lua/Repos/lua-dev-examples/lua-shopping-assistant/src/tools/EcommerceTool.ts';\n\n// Instantiate the tool class\nconst toolInstance = new CheckoutTool();\n\n// Runtime metadata\nconst __lua_primitive__ = {\n  version: '2.0.0',\n  kind: 'tool',\n  name: \"checkout\",\n  description: \"Complete purchase and create order\",\n  exportName: \"CheckoutTool\",\n  pattern: 'class',\n};\n\n// Wrap class instance to match primitive interface\nexport default {\n  __lua_primitive__,\n  primitive: {\n    kind: 'tool',\n    name: toolInstance.name,\n    description: toolInstance.description,\n    inputSchema: toolInstance.inputSchema,\n    execute: toolInstance.execute.bind(toolInstance),\n    condition: toolInstance.condition?.bind(toolInstance),\n  },\n};\n\nexport { CheckoutTool };\n", "import { LuaTool, Products, Baskets, Orders } from \"lua-cli\";\nimport { z } from \"zod\";\n\n// 1. Search Products\nexport class SearchProductsTool implements LuaTool {\n  name = \"search_products\";\n  description = \"Search for products by name, category, or description\";\n  \n  inputSchema = z.object({\n    query: z.string().describe(\"Search query (e.g., 'laptop', 'running shoes')\"),\n    maxPrice: z.number().optional().describe(\"Maximum price filter\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    const results = await Products.search(input.query);\n    \n    // Filter by max price if specified\n    let products = results.data;\n    if (input.maxPrice) {\n      products = products.filter(p => p.price <= input.maxPrice);\n    }\n    \n    return {\n      products: products.slice(0, 10).map(p => ({\n        id: p.id,\n        name: p.name,\n        price: `$${p.price.toFixed(2)}`,\n        category: p.category,\n        inStock: p.inStock,\n        description: p.description?.substring(0, 100) + '...'\n      })),\n      total: products.length,\n      showing: Math.min(products.length, 10)\n    };\n  }\n}\n\n// 2. Browse Products by Category/Price (Filter-based)\nexport class BrowseProductsTool implements LuaTool {\n  name = \"browse_products\";\n  description = \"Browse products by category, price range, or availability. Use this for structured browsing instead of search.\";\n  \n  inputSchema = z.object({\n    category: z.string().optional().describe(\"Product category (e.g., 'Electronics', 'Clothing')\"),\n    minPrice: z.number().optional().describe(\"Minimum price\"),\n    maxPrice: z.number().optional().describe(\"Maximum price\"),\n    inStockOnly: z.boolean().optional().describe(\"Only show in-stock items\"),\n    page: z.number().optional().default(1).describe(\"Page number for pagination\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    // Build filter from input\n    const filter: Record<string, any> = {};\n    \n    if (input.category) {\n      filter.category = input.category;\n    }\n    \n    if (input.minPrice !== undefined || input.maxPrice !== undefined) {\n      filter.price = {};\n      if (input.minPrice !== undefined) filter.price.$gte = input.minPrice;\n      if (input.maxPrice !== undefined) filter.price.$lte = input.maxPrice;\n    }\n    \n    if (input.inStockOnly) {\n      filter.inStock = true;\n    }\n    \n    const results = await Products.get({\n      page: input.page,\n      limit: 10,\n      filter\n    });\n    \n    return {\n      products: results.data.map(p => ({\n        id: p.id,\n        name: p.name,\n        price: `$${p.price.toFixed(2)}`,\n        category: p.category,\n        inStock: p.inStock ? '\u2705 In Stock' : '\u274C Out of Stock',\n        description: p.description?.substring(0, 100) + '...'\n      })),\n      pagination: {\n        page: results.pagination.currentPage,\n        totalPages: results.pagination.totalPages,\n        totalProducts: results.pagination.totalCount,\n        hasMore: results.pagination.hasNextPage\n      }\n    };\n  }\n}\n\n// 3. Get Product Details\nexport class GetProductDetailsTool implements LuaTool {\n  name = \"get_product_details\";\n  description = \"Get detailed information about a specific product\";\n  \n  inputSchema = z.object({\n    productId: z.string().describe(\"Product ID\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    const product = await Products.getById(input.productId);\n    \n    if (!product) {\n      throw new Error(`Product not found: ${input.productId}`);\n    }\n    \n    return {\n      id: product.id,\n      name: product.name,\n      price: `$${product.price.toFixed(2)}`,\n      description: product.description,\n      category: product.category,\n      sku: product.sku,\n      inStock: product.inStock,\n      availability: product.inStock \n        ? \"\u2705 In stock - Ships within 24 hours\" \n        : \"\u274C Out of stock - Notify when available?\"\n    };\n  }\n}\n\n// 4. Add to Cart\nexport class AddToCartTool implements LuaTool {\n  name = \"add_to_cart\";\n  description = \"Add a product to the shopping cart\";\n  \n  inputSchema = z.object({\n    productId: z.string().describe(\"Product ID to add\"),\n    quantity: z.number().min(1).default(1).describe(\"Quantity to add\"),\n    basketId: z.string().optional().describe(\"Existing basket ID (creates new if not provided)\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    // Get product details\n    const product = await Products.getById(input.productId);\n    \n    if (!product) {\n      throw new Error(`Product not found: ${input.productId}`);\n    }\n    \n    if (!product.inStock) {\n      return {\n        success: false,\n        message: `Sorry, ${product.name} is currently out of stock`\n      };\n    }\n    \n    // Get or create basket\n    let basket;\n    if (input.basketId) {\n      basket = await Baskets.getById(input.basketId);\n    } else {\n      basket = await Baskets.create({\n        currency: 'USD',\n        metadata: { source: 'ai_chat' }\n      });\n    }\n    \n    // Add item to basket\n    const updated = await Baskets.addItem(basket.id, {\n      id: input.productId,\n      price: product.price,\n      quantity: input.quantity,\n      SKU: product.sku\n    });\n    \n    return {\n      success: true,\n      basketId: updated.id,\n      itemCount: updated.common.itemCount,\n      subtotal: `$${updated.common.totalAmount.toFixed(2)}`,\n      message: `Added ${input.quantity}x ${product.name} to your cart`\n    };\n  }\n}\n\n// 5. View Cart\nexport class ViewCartTool implements LuaTool {\n  name = \"view_cart\";\n  description = \"View items in the shopping cart\";\n  \n  inputSchema = z.object({\n    basketId: z.string().describe(\"Basket ID\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    const basket = await Baskets.getById(input.basketId);\n    \n    if (!basket) {\n      throw new Error(\"Cart not found\");\n    }\n    \n    return {\n      items: basket.common.items.map(item => ({\n        productId: item.id,\n        quantity: item.quantity,\n        price: `$${item.price.toFixed(2)}`,\n        subtotal: `$${(item.price * item.quantity).toFixed(2)}`,\n        sku: item.SKU\n      })),\n      itemCount: basket.common.itemCount,\n      total: `$${basket.common.totalAmount.toFixed(2)}`,\n      basketId: basket.id\n    };\n  }\n}\n\n// 6. Remove from Cart\nexport class RemoveFromCartTool implements LuaTool {\n  name = \"remove_from_cart\";\n  description = \"Remove an item from the shopping cart\";\n  \n  inputSchema = z.object({\n    basketId: z.string(),\n    itemId: z.string().describe(\"Item/Product ID to remove\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    await Baskets.removeItem(input.basketId, input.itemId);\n    \n    const updated = await Baskets.getById(input.basketId);\n    \n    return {\n      success: true,\n      itemCount: updated.common.itemCount,\n      total: `$${updated.common.totalAmount.toFixed(2)}`,\n      message: \"Item removed from cart\"\n    };\n  }\n}\n\n// 7. Checkout\nexport class CheckoutTool implements LuaTool {\n  name = \"checkout\";\n  description = \"Complete purchase and create order\";\n  \n  inputSchema = z.object({\n    basketId: z.string(),\n    shippingAddress: z.object({\n      name: z.string(),\n      street: z.string(),\n      city: z.string(),\n      state: z.string(),\n      zip: z.string(),\n      country: z.string().default('USA')\n    }),\n    email: z.string().email(),\n    paymentMethod: z.string().default('stripe')\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    const basket = await Baskets.getById(input.basketId);\n    \n    if (basket.common.itemCount === 0) {\n      return {\n        success: false,\n        message: \"Cannot checkout with empty cart\"\n      };\n    }\n    \n    // Create order\n    const order = await Baskets.placeOrder({\n      shippingAddress: input.shippingAddress,\n      paymentMethod: input.paymentMethod,\n      customerEmail: input.email\n    }, input.basketId);\n    \n    return {\n      success: true,\n      orderId: order.id,\n      total: `$${basket.common.totalAmount.toFixed(2)}`,\n      itemCount: basket.common.itemCount,\n      estimatedDelivery: this.calculateDeliveryDate(),\n      message: `Order confirmed! You'll receive a confirmation email at ${input.email}`\n    };\n  }\n  \n  private calculateDeliveryDate(): string {\n    const date = new Date();\n    date.setDate(date.getDate() + 5); // 5 business days\n    return date.toLocaleDateString();\n  }\n}\n\n// 8. Track Order\nexport class TrackOrderTool implements LuaTool {\n  name = \"track_order\";\n  description = \"Get order status and tracking information\";\n  \n  inputSchema = z.object({\n    orderId: z.string().describe(\"Order ID to track\")\n  });\n\n  async execute(input: z.infer<typeof this.inputSchema>) {\n    const order = await Orders.getById(input.orderId);\n    \n    if (!order) {\n      throw new Error(`Order not found: ${input.orderId}`);\n    }\n    \n    const statusMessages = {\n      pending: \"Your order is being processed\",\n      confirmed: \"Order confirmed and being prepared for shipping\",\n      fulfilled: \"Order delivered!\",\n      cancelled: \"Order was cancelled\"\n    };\n    \n    return {\n      orderId: order.id,\n      status: order.common.status,\n      statusMessage: statusMessages[order.common.status] || \"Unknown status\",\n      total: `$${order.common.totalAmount.toFixed(2)}`,\n      itemCount: order.common.itemCount,\n      estimatedDelivery: order.data?.estimatedDelivery,\n      trackingNumber: order.data?.trackingNumber\n    };\n  }\n}\n\n"],
  "mappings": "yaAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,kBAAAE,EAAA,YAAAC,IAAA,eAAAC,EAAAJ,GCAA,IAAAK,EAAmD,mBACnDC,EAAkB,eA0OX,IAAMC,EAAN,KAAsC,CAAtC,cACL,UAAO,WACP,iBAAc,qCAEd,iBAAc,IAAE,OAAO,CACrB,SAAU,IAAE,OAAO,EACnB,gBAAiB,IAAE,OAAO,CACxB,KAAM,IAAE,OAAO,EACf,OAAQ,IAAE,OAAO,EACjB,KAAM,IAAE,OAAO,EACf,MAAO,IAAE,OAAO,EAChB,IAAK,IAAE,OAAO,EACd,QAAS,IAAE,OAAO,EAAE,QAAQ,KAAK,CACnC,CAAC,EACD,MAAO,IAAE,OAAO,EAAE,MAAM,EACxB,cAAe,IAAE,OAAO,EAAE,QAAQ,QAAQ,CAC5C,CAAC,EAED,MAAM,QAAQC,EAAyC,CACrD,IAAMC,EAAS,MAAM,UAAQ,QAAQD,EAAM,QAAQ,EAEnD,OAAIC,EAAO,OAAO,YAAc,EACvB,CACL,QAAS,GACT,QAAS,iCACX,EAUK,CACL,QAAS,GACT,SARY,MAAM,UAAQ,WAAW,CACrC,gBAAiBD,EAAM,gBACvB,cAAeA,EAAM,cACrB,cAAeA,EAAM,KACvB,EAAGA,EAAM,QAAQ,GAIA,GACf,MAAO,IAAIC,EAAO,OAAO,YAAY,QAAQ,CAAC,CAAC,GAC/C,UAAWA,EAAO,OAAO,UACzB,kBAAmB,KAAK,sBAAsB,EAC9C,QAAS,2DAA2DD,EAAM,KAAK,EACjF,CACF,CAEQ,uBAAgC,CACtC,IAAME,EAAO,IAAI,KACjB,OAAAA,EAAK,QAAQA,EAAK,QAAQ,EAAI,CAAC,EACxBA,EAAK,mBAAmB,CACjC,CACF,EDnRA,IAAMC,EAAe,IAAIC,EAGnBC,EAAoB,CACxB,QAAS,QACT,KAAM,OACN,KAAM,WACN,YAAa,qCACb,WAAY,eACZ,QAAS,OACX,EAGOC,EAAQ,CACb,kBAAAD,EACA,UAAW,CACT,KAAM,OACN,KAAMF,EAAa,KACnB,YAAaA,EAAa,YAC1B,YAAaA,EAAa,YAC1B,QAASA,EAAa,QAAQ,KAAKA,CAAY,EAC/C,UAAWA,EAAa,WAAW,KAAKA,CAAY,CACtD,CACF",
  "names": ["tool_checkout_exports", "__export", "CheckoutTool", "tool_checkout_default", "__toCommonJS", "import_lua_cli", "import_zod", "CheckoutTool", "input", "basket", "date", "toolInstance", "CheckoutTool", "__lua_primitive__", "tool_checkout_default"]
}
